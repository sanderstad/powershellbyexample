<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Functions | PowerShell By Example</title>
<link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-WRS58SRCQM"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WRS58SRCQM")}</script><title>PowerShell By Example</title>
<meta name=description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta name=keywords content="powershell,progamming,tutorial"><link rel=alternate type=application/rss+xml href=https://powershellbyexample.dev/index.xml title=powershellbyexample.dev><link rel=icon type=image/png sizes=32x32 href=https://powershellbyexample.dev/icons/favicon-32x32.png><meta name=twitter:image:src content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta name=twitter:site content="@sqlstad"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Learning PowerShell By Example"><meta name=twitter:description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta property="og:image" content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta property="og:image:alt" content="PowerShell by Example"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="600"><meta property="og:site_name" content="PowerShell By Example"><meta property="og:type" content="object"><meta property="og:title" content="Learning PowerShell By Example"><meta property="og:url" content="https://powershellbyexample.dev"><meta property="og:description" content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><script type=text/javascript>sdkInstance="appInsightsSDK",window[sdkInstance]="appInsights";var sdkInstance,aiName=window[sdkInstance],aisdk=window[aiName]||function(e){function n(e){t[e]=function(){var n=arguments;t.queue.push(function(){t[e].apply(t,n)})}}t={config:e},t.initialize=!0;var t,s,i,a,o=document,r=window;setTimeout(function(){var t=o.createElement("script");t.src=e.url||"https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",o.getElementsByTagName("script")[0].parentNode.appendChild(t)});try{t.cookie=o.cookie}catch{}t.queue=[],t.version=2;for(s=["Event","PageView","Exception","Trace","DependencyData","Metric","PageViewPerformance"];s.length;)n("track"+s.pop());return n("startTrackPage"),n("stopTrackPage"),i="Track"+s[0],(n("start"+i),n("stop"+i),n("setAuthenticatedUserContext"),n("clearAuthenticatedUserContext"),n("flush"),!(!0===e.disableExceptionTracking||e.extensionConfig&&e.extensionConfig.ApplicationInsightsAnalytics&&!0===e.extensionConfig.ApplicationInsightsAnalytics.disableExceptionTracking))&&(n("_"+(s="onerror")),a=r[s],r[s]=function(e,n,o,i,r){var c=a&&a(e,n,o,i,r);return!0!==c&&t["_"+s]({message:e,url:n,lineNumber:o,columnNumber:i,error:r}),c},e.autoExceptionInstrumented=!0),t}({instrumentationKey:"182786de-33f9-4d34-abc9-68ce85a717a0"});window[aiName]=aisdk,aisdk.queue&&0===aisdk.queue.length&&aisdk.trackPageView({})</script></head><body><nav><ul class=menu></ul><hr></nav><div class=article-meta><h1><span class=title><a href=https://powershellbyexample.dev/>PowerShell By Example</a>: Functions</span></h1></div><main><p>Functions are not required in PowerShell, but when your code becomes repetitive you should consider using functions.
Also when creating PowerShell modules you should really consider putting code into functions to make your code more readable.</p><p>To create a function we use the <code>function</code> keyword:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> writeHelloWorld() {
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;Hello World!&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>writeHelloWorld
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Hello World!
</code></pre><p>Obviously this function is not very useful, but it is a good example how easy it is to create a function.</p><h2 id=parameters>Parameters</h2><p>Parameters is where the magic happens. When you create a function you can pass parameters to it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> writeMessage {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>param</span>(
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>string</span>]$Message
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;Message: </span>$Message<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>writeMessage <span style=color:#e6db74>&#34;Hello World!&#34;</span>
</span></span><span style=display:flex><span>writeMessage -message <span style=color:#e6db74>&#34;Who is there?&#34;</span>
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Message: Hello World!
Message: Who is there?
</code></pre><p>Notice that we can pass parameters with and without specifying the parameter.</p><h2 id=adding-advanced-functionality>Adding advanced functionality</h2><p>To make a function more advanced we can add <code>[CmdletBinding()]</code> to the function.
This enabled you to support for:</p><ul><li>Confirming for impact</li><li>Help URI</li><li>Support paging</li><li>Should process</li><li>Positional binding</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> writeMessage {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>param</span>(
</span></span><span style=display:flex><span>        [Parameter(<span style=color:#a6e22e>Mandatory</span> = $true, <span style=color:#a6e22e>Position</span> = <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>HelpMessage</span> = <span style=color:#e6db74>&#34;The message to write&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>string</span>]$Message
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>process</span> {
</span></span><span style=display:flex><span>        Write-Host <span style=color:#e6db74>&#34;Message: </span>$message<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>writeMessage <span style=color:#e6db74>&#34;Hello World!&#34;</span>
</span></span><span style=display:flex><span>writeMessage
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Message: Hello World!
cmdlet writeMessage at command pipeline position 1
Supply values for the following parameters:
Message:
writeMessage: C:\temp\temp.ps1:14:1
Line |
  14 |  writeMessage
     |  ~~~~~~~~~~~~
     | Cannot bind argument to parameter &#39;Message&#39; because it is an empty string.
</code></pre><p>Notice that the function also includes the <code>process</code> keyword.</p><h2 id=begin-process-and-end>Begin, process and End</h2><p>These blocks are not required but they are very useful when you want to execute code before or after the function.</p><p><em>Begin</em> is used for one-time processing before the rest of the function is executed.
<em>Process</em> is used for processing the function.
<em>End</em> is used for one-time processing after the rest of the function is executed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> writeMessage {
</span></span><span style=display:flex><span>    [CmdLetBinding()]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>param</span>(
</span></span><span style=display:flex><span>        [Parameter(<span style=color:#a6e22e>Mandatory</span> = $true, <span style=color:#a6e22e>Position</span> = <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>HelpMessage</span> = <span style=color:#e6db74>&#34;The message to write&#34;</span>)]
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>string</span>]$Message
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>begin</span> {
</span></span><span style=display:flex><span>        Write-Verbose <span style=color:#e6db74>&#34;Beginning of script&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (($null <span style=color:#f92672>-eq</span> $Message) <span style=color:#f92672>-or</span> ($Message <span style=color:#f92672>-eq</span> <span style=color:#e6db74>&#34;&#34;</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#e6db74>&#34;Message cannot be empty&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>process</span> {
</span></span><span style=display:flex><span>        Write-Host <span style=color:#e6db74>&#34;Message: </span>$message<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span> {
</span></span><span style=display:flex><span>        Write-Host <span style=color:#e6db74>&#34;End of script&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>writeMessage <span style=color:#e6db74>&#34;Hello World!&#34;</span> -Verbose
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Beginning of script
Message: Hello World!
End of script
</code></pre><p>For more information about advanced function go to the Microsoft Docs website:</p><ul><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions?view=powershell-7.2">Functions</a></li><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced?view=powershell-7.2">Advanced Functions</a></li><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced_parameters?view=powershell-7.2">Advanced Parameters</a></li></ul></main><a class=previous href=/post/variable-scopes/>Next: Scopes<footer><p><a href=https://powershellbyexample.dev/>Home</a></p><p>by <a href=https://sqlstad.nl target=_blank>Sander Stad</a> |
<a href=https://github.com/sanderstad/powershellbyexample target=_blank>source</a> |
<a href=https://github.com/sanderstad/powershellbyexample/blob/main/LICENSE target=_blank>license</a></p></footer></body></html>