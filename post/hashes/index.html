<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Cryptographic Hashing | PowerShell By Example</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-WRS58SRCQM"></script><script>var dnt,doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WRS58SRCQM")}</script><title>PowerShell By Example</title><meta name=description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta name=keywords content="powershell,progamming,tutorial"><link rel=alternate type=application/rss+xml href=https://powershellbyexample.dev/index.xml title=powershellbyexample.dev><link rel=icon type=image/png sizes=32x32 href=https://powershellbyexample.dev/icons/favicon-32x32.png><meta name=twitter:image:src content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta name=twitter:site content="@sqlstad"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Learning PowerShell By Example"><meta name=twitter:description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta property="og:image" content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta property="og:image:alt" content="PowerShell by Example"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="600"><meta property="og:site_name" content="PowerShell By Example"><meta property="og:type" content="object"><meta property="og:title" content="Learning PowerShell By Example"><meta property="og:url" content="https://powershellbyexample.dev"><meta property="og:description" content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><script type=text/javascript>sdkInstance="appInsightsSDK",window[sdkInstance]="appInsights";var sdkInstance,aiName=window[sdkInstance],aisdk=window[aiName]||function(e){function n(e){t[e]=function(){var n=arguments;t.queue.push(function(){t[e].apply(t,n)})}}t={config:e},t.initialize=!0;var t,s,i,a,o=document,r=window;setTimeout(function(){var t=o.createElement("script");t.src=e.url||"https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",o.getElementsByTagName("script")[0].parentNode.appendChild(t)});try{t.cookie=o.cookie}catch{}t.queue=[],t.version=2;for(s=["Event","PageView","Exception","Trace","DependencyData","Metric","PageViewPerformance"];s.length;)n("track"+s.pop());return n("startTrackPage"),n("stopTrackPage"),i="Track"+s[0],(n("start"+i),n("stop"+i),n("setAuthenticatedUserContext"),n("clearAuthenticatedUserContext"),n("flush"),!(!0===e.disableExceptionTracking||e.extensionConfig&&e.extensionConfig.ApplicationInsightsAnalytics&&!0===e.extensionConfig.ApplicationInsightsAnalytics.disableExceptionTracking))&&(n("_"+(s="onerror")),a=r[s],r[s]=function(e,n,o,i,r){var c=a&&a(e,n,o,i,r);return!0!==c&&t["_"+s]({message:e,url:n,lineNumber:o,columnNumber:i,error:r}),c},e.autoExceptionInstrumented=!0),t}({instrumentationKey:"182786de-33f9-4d34-abc9-68ce85a717a0"});window[aiName]=aisdk,aisdk.queue&&0===aisdk.queue.length&&aisdk.trackPageView({})</script></head><body><nav><ul class=menu></ul><hr></nav><div class=article-meta><h1><span class=title><a href=https://powershellbyexample.dev/>PowerShell By Example</a>: Cryptographic Hashing</span></h1></div><main><p>Hashing is the process of converting data into a fixed-length string using a mathematical algorithm. The same input always produces the same output, but the output cannot be reversed to recover the original input. Hashes are commonly used to verify file integrity, store passwords securely, and detect data changes.</p><p>PowerShell provides built-in support for hashing through <code>Get-FileHash</code> and the .NET <code>[System.Security.Cryptography]</code> namespace.</p><hr><h1 id=get-filehash>Get-FileHash</h1><p><code>Get-FileHash</code> computes the hash of a file. By default it uses SHA256.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-FileHash -Path <span style=color:#e6db74>&#34;C:\Temp\example.txt&#34;</span>
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Algorithm       Hash                                                             Path
---------       ----                                                             ----
SHA256          3B4C5D6E7F8A9B0C1D2E3F4A5B6C7D8E9F0A1B2C3D4E5F6A7B8C9D0E1F2A3B4  C:\Temp\example.txt
</code></pre><h2 id=choosing-an-algorithm>Choosing an Algorithm</h2><p>The <code>-Algorithm</code> parameter lets you select from: <code>MD5</code>, <code>SHA1</code>, <code>SHA256</code>, <code>SHA384</code>, or <code>SHA512</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-FileHash -Path <span style=color:#e6db74>&#34;C:\Temp\example.txt&#34;</span> -Algorithm MD5
</span></span><span style=display:flex><span>Get-FileHash -Path <span style=color:#e6db74>&#34;C:\Temp\example.txt&#34;</span> -Algorithm SHA1
</span></span><span style=display:flex><span>Get-FileHash -Path <span style=color:#e6db74>&#34;C:\Temp\example.txt&#34;</span> -Algorithm SHA512
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Algorithm       Hash                                 Path
---------       ----                                 ----
MD5             D41D8CD98F00B204E9800998ECF8427E     C:\Temp\example.txt
SHA1            DA39A3EE5E6B4B0D3255BFEF95601890AFD  C:\Temp\example.txt
SHA512          CF83E1357EEFB8BDF1542850D66D8007D6...  C:\Temp\example.txt
</code></pre><blockquote><p>Note: MD5 and SHA1 are considered cryptographically weak and should not be used for security purposes. Prefer SHA256 or higher.</p></blockquote><hr><h1 id=hashing-a-string>Hashing a String</h1><p><code>Get-FileHash</code> works on files, but you can hash a string by converting it to a stream first.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> Get-StringHash {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>param</span>(
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>string</span>]$Value,
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>string</span>]$Algorithm = <span style=color:#e6db74>&#34;SHA256&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $stream = [<span style=color:#66d9ef>System.IO.MemoryStream</span>]::new(
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>System.Text.Encoding</span>]::UTF8.GetBytes($Value)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    (Get-FileHash -InputStream $stream -Algorithm $Algorithm).Hash
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Get-StringHash -Value <span style=color:#e6db74>&#34;Hello, World!&#34;</span>
</span></span><span style=display:flex><span>Get-StringHash -Value <span style=color:#e6db74>&#34;Hello, World!&#34;</span> -Algorithm MD5
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>DFFD6021BB2BD5B0AF676290809EC3A53191DD81C7F70A4B28688A362182986F
65A8E27D8879283831B664BD8B7F0AD4
</code></pre><hr><h1 id=verifying-file-integrity>Verifying File Integrity</h1><p>A common use case is verifying a downloaded file matches its published checksum.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>$expectedHash = <span style=color:#e6db74>&#34;3B4C5D6E7F8A9B0C1D2E3F4A5B6C7D8E9F0A1B2C3D4E5F6A7B8C9D0E1F2A3B4&#34;</span>
</span></span><span style=display:flex><span>$actualHash   = (Get-FileHash -Path <span style=color:#e6db74>&#34;C:\Temp\example.txt&#34;</span>).Hash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($actualHash <span style=color:#f92672>-eq</span> $expectedHash) {
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;File is valid. Hash matches.&#34;</span>
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;WARNING: Hash mismatch! File may be corrupted or tampered with.&#34;</span>
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;Expected: </span>$expectedHash<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;Actual:   </span>$actualHash<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Result (on a matching file):</p><pre tabindex=0><code>File is valid. Hash matches.
</code></pre><p>Note that the <code>-eq</code> comparison is case-insensitive, so you don&rsquo;t need to normalise the case of the hash string. See <a href=/post/case-sensitivity>Case Sensitivity</a> for more on this.</p><hr><h1 id=hashing-multiple-files>Hashing Multiple Files</h1><p>You can pipe a list of files to <code>Get-FileHash</code> to hash them all at once.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-ChildItem -Path <span style=color:#e6db74>&#34;C:\Temp&#34;</span> <span style=color:#f92672>-File</span> | Get-FileHash -Algorithm SHA256
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Algorithm       Hash                                                             Path
---------       ----                                                             ----
SHA256          A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6E7F8A9B0C1D2E3F4A5B6C7D8E9F0  C:\Temp\file1.txt
SHA256          B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6E7F8A9B0C1D2E3F4A5B6C7D8E9F0A1  C:\Temp\file2.txt
SHA256          C3D4E5F6A7B8C9D0E1F2A3B4C5D6E7F8A9B0C1D2E3F4A5B6C7D8E9F0A1B2  C:\Temp\file3.txt
</code></pre><hr><h1 id=comparing-two-files>Comparing Two Files</h1><p>You can use hashes to quickly check whether two files are identical without comparing them byte by byte.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>$hash1 = (Get-FileHash -Path <span style=color:#e6db74>&#34;C:\Temp\original.txt&#34;</span>).Hash
</span></span><span style=display:flex><span>$hash2 = (Get-FileHash -Path <span style=color:#e6db74>&#34;C:\Temp\copy.txt&#34;</span>).Hash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($hash1 <span style=color:#f92672>-eq</span> $hash2) {
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;Files are identical.&#34;</span>
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;Files are different.&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Files are identical.
</code></pre><hr><h1 id=using-net-directly>Using .NET Directly</h1><p>For more control, or for hashing data that is not a file, you can use .NET&rsquo;s <code>System.Security.Cryptography</code> namespace.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>$data      = [<span style=color:#66d9ef>System.Text.Encoding</span>]::UTF8.GetBytes(<span style=color:#e6db74>&#34;Hello, World!&#34;</span>)
</span></span><span style=display:flex><span>$sha256    = [<span style=color:#66d9ef>System.Security.Cryptography.SHA256</span>]::Create()
</span></span><span style=display:flex><span>$hashBytes = $sha256.ComputeHash($data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Convert byte array to hex string</span>
</span></span><span style=display:flex><span>$hashHex = [<span style=color:#66d9ef>System.BitConverter</span>]::ToString($hashBytes) <span style=color:#f92672>-replace</span> <span style=color:#e6db74>&#34;-&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$hashHex
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>DFFD6021BB2BD5B0AF676290809EC3A53191DD81C7F70A4B28688A362182986F
</code></pre><hr><h1 id=summary>Summary</h1><table><thead><tr><th>Method</th><th>Use case</th></tr></thead><tbody><tr><td><code>Get-FileHash</code></td><td>Hash files on disk, simple and built-in</td></tr><tr><td><code>Get-FileHash -InputStream</code></td><td>Hash strings or in-memory data</td></tr><tr><td><code>[System.Security.Cryptography]</code></td><td>Fine-grained control, any data type</td></tr></tbody></table><p>Prefer <strong>SHA256</strong> or higher for any security-sensitive purpose. Use MD5 only when interoperability with legacy systems requires it.</p></main><a class=previous href=/post/writing-files/>Next: Writing Files<footer><p><a href=https://powershellbyexample.dev/>Home</a></p><p>by <a href=https://sqlstad.nl target=_blank>Sander Stad</a> |
<a href=https://github.com/sanderstad/powershellbyexample target=_blank>source</a> |
<a href=https://github.com/sanderstad/powershellbyexample/blob/main/LICENSE target=_blank>license</a></p></footer></body></html>