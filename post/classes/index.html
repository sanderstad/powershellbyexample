<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Classes | PowerShell By Example</title>
<link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-WRS58SRCQM"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WRS58SRCQM")}</script><title>PowerShell By Example</title>
<meta name=description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta name=keywords content="powershell,progamming,tutorial"><link rel=alternate type=application/rss+xml href=https://powershellbyexample.dev/index.xml title=powershellbyexample.dev><link rel=icon type=image/png sizes=32x32 href=https://powershellbyexample.dev/icons/favicon-32x32.png><meta name=twitter:image:src content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta name=twitter:site content="@sqlstad"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Learning PowerShell By Example"><meta name=twitter:description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta property="og:image" content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta property="og:image:alt" content="PowerShell by Example"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="600"><meta property="og:site_name" content="PowerShell By Example"><meta property="og:type" content="object"><meta property="og:title" content="Learning PowerShell By Example"><meta property="og:url" content="https://powershellbyexample.dev"><meta property="og:description" content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><script type=text/javascript>sdkInstance="appInsightsSDK",window[sdkInstance]="appInsights";var sdkInstance,aiName=window[sdkInstance],aisdk=window[aiName]||function(e){function n(e){t[e]=function(){var n=arguments;t.queue.push(function(){t[e].apply(t,n)})}}t={config:e},t.initialize=!0;var t,s,i,a,o=document,r=window;setTimeout(function(){var t=o.createElement("script");t.src=e.url||"https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",o.getElementsByTagName("script")[0].parentNode.appendChild(t)});try{t.cookie=o.cookie}catch{}t.queue=[],t.version=2;for(s=["Event","PageView","Exception","Trace","DependencyData","Metric","PageViewPerformance"];s.length;)n("track"+s.pop());return n("startTrackPage"),n("stopTrackPage"),i="Track"+s[0],(n("start"+i),n("stop"+i),n("setAuthenticatedUserContext"),n("clearAuthenticatedUserContext"),n("flush"),!(!0===e.disableExceptionTracking||e.extensionConfig&&e.extensionConfig.ApplicationInsightsAnalytics&&!0===e.extensionConfig.ApplicationInsightsAnalytics.disableExceptionTracking))&&(n("_"+(s="onerror")),a=r[s],r[s]=function(e,n,o,i,r){var c=a&&a(e,n,o,i,r);return!0!==c&&t["_"+s]({message:e,url:n,lineNumber:o,columnNumber:i,error:r}),c},e.autoExceptionInstrumented=!0),t}({instrumentationKey:"182786de-33f9-4d34-abc9-68ce85a717a0"});window[aiName]=aisdk,aisdk.queue&&0===aisdk.queue.length&&aisdk.trackPageView({})</script></head><body><nav><ul class=menu></ul><hr></nav><div class=article-meta><h1><span class=title><a href=https://powershellbyexample.dev/>PowerShell By Example</a>: Classes</span></h1></div><main><p>Since PowerShell 5 you are able to create your own classes in PowerShell.</p><p>Although classes in other programming languages are a big advantage and sometimes even required, they are not required in PowerShell.</p><p>In some cases you may want to use classes in PowerShell to create objects that can be used in PowerShell. One of those examples is when you use DSC (Desired State Configuration).
Most of the time you will not need to use classes in PowerShell, and you will be fine using custom objects in your commands instead.</p><h1 id=create-a-class>Create a class</h1><p>To create a class we need to use the <code>class</code> keyword. The example below shows an example of a class.<br>It also shows how to use the <code>new</code> keyword to create an instance of the class.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>class</span> Tree {
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Height
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Age
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>string</span>]$Color
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree1 = new-object Tree
</span></span><span style=display:flex><span>$tree2 = [<span style=color:#66d9ef>Tree</span>]::new()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree1.Height = <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>$tree1.Age = <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>$tree1.Color = <span style=color:#e6db74>&#34;Red&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree2.Height = <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>$tree2.Age = <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>$tree2.Color = <span style=color:#e6db74>&#34;Green&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree1
</span></span><span style=display:flex><span>$tree2
</span></span></code></pre></div><p>The result should look something like this:</p><pre tabindex=0><code>------ --- -----
    10   5 Red
    20  10 Green
</code></pre><p>As you can see we can use the <code>New-Object</code> command or the <code>new()</code> keyword to create an instance of the class.</p><h1 id=constructors>Constructors</h1><p>When creating a class you can also create a constructor. The constructor is a special method that is called when you create an instance of the class.<br>This can be very useful when you want to initialize some properties of the class.</p><p>The example below demonstrates how to create multiple constructors for the class.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>class</span> Tree {
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Height
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Age
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>string</span>]$Color
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Tree() {
</span></span><span style=display:flex><span>        $this.Height = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        $this.Age = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        $this.Color = <span style=color:#e6db74>&#34;Green&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Tree([<span style=color:#66d9ef>int</span>]$Height, [<span style=color:#66d9ef>int</span>]$Age, [<span style=color:#66d9ef>string</span>]$Color) {
</span></span><span style=display:flex><span>        $this.Height = $Height;
</span></span><span style=display:flex><span>        $this.Age = $Age;
</span></span><span style=display:flex><span>        $this.Color = $Color;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree1 = [<span style=color:#66d9ef>Tree</span>]::New()
</span></span><span style=display:flex><span>$tree2 = New-Object Tree <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#34;Red&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree1
</span></span><span style=display:flex><span>$tree2
</span></span></code></pre></div><p>The result should look something like this:</p><pre tabindex=0><code>Height Age Color
------ --- -----
     1   0 Green
     5   2 Red
</code></pre><p>In the example above you can see the first object is created with the default constructor and does not accept any parameters. This can be handy to initialize variables when the object is created.
The second object is created using another constructor and accepts three parameters.</p><h1 id=creating-methods>Creating methods</h1><p>We technically don&rsquo;t need to create methods to set values in the class because all the properties can be retrieved and set using the default methods.<br>In some situations you may want to create methods to set values in the class.</p><p>In the example below we create a method to let the tree grow by increasing the age and the height.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>class</span> Tree {
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Height
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Age
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>string</span>]$Color
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Initialize the tree by setting default values</span>
</span></span><span style=display:flex><span>    Tree() {
</span></span><span style=display:flex><span>        $this.Height = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        $this.Age = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        $this.Color = <span style=color:#e6db74>&#34;Green&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create a constructor with parameters a.k.a. constructor overloading</span>
</span></span><span style=display:flex><span>    Tree([<span style=color:#66d9ef>int</span>]$Height, [<span style=color:#66d9ef>int</span>]$Age, [<span style=color:#66d9ef>string</span>]$Color) {
</span></span><span style=display:flex><span>        $this.Height = $Height
</span></span><span style=display:flex><span>        $this.Age = $Age
</span></span><span style=display:flex><span>        $this.Color = $Color
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>void</span>]Grow() {
</span></span><span style=display:flex><span>        <span style=color:#75715e># Get a random height because plants and trees don&#39;t grow the same each year</span>
</span></span><span style=display:flex><span>        $heightIncrease = Get-Random -Min <span style=color:#ae81ff>1</span> -Max <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>        $this.Height += $heightIncrease;
</span></span><span style=display:flex><span>        $this.Age += <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree = [<span style=color:#66d9ef>Tree</span>]::New()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Let the tree grow for 10 years</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> ($i = <span style=color:#ae81ff>0</span>; $i <span style=color:#f92672>-lt</span> <span style=color:#ae81ff>10</span>; $i++) {
</span></span><span style=display:flex><span>    $tree.Grow()
</span></span><span style=display:flex><span>    $tree
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The result should look something like this:</p><pre tabindex=0><code>Height Age Color
------ --- -----
     3   1 Green
     7   2 Green
    10   3 Green
    11   4 Green
    15   5 Green
    16   6 Green
    20   7 Green
    24   8 Green
    26   9 Green
    28  10 Green
</code></pre><h1 id=class-inheritance>Class inheritance</h1><p>The examples are all good to use with classes but can be done very easily without using classes.<br>Where classes become useful is when you start to use inheritance.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>class</span> Tree {
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Height
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>int</span>]$Age
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>string</span>]$Color
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Tree() {
</span></span><span style=display:flex><span>        $this.Height = <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        $this.Age = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        $this.Color = <span style=color:#e6db74>&#34;Green&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Tree([<span style=color:#66d9ef>int</span>]$Height, [<span style=color:#66d9ef>int</span>]$Age, [<span style=color:#66d9ef>string</span>]$Color) {
</span></span><span style=display:flex><span>        $this.Height = $Height;
</span></span><span style=display:flex><span>        $this.Age = $Age;
</span></span><span style=display:flex><span>        $this.Color = $Color;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>void</span>]Grow() {
</span></span><span style=display:flex><span>        <span style=color:#75715e># Get a random height because plants and trees don&#39;t grow the same each year</span>
</span></span><span style=display:flex><span>        $heightIncrease = Get-Random -Min <span style=color:#ae81ff>1</span> -Max <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>        $this.Height += $heightIncrease;
</span></span><span style=display:flex><span>        $this.Age += <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> AppleTree : Tree {
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>string</span>]$Spieces = <span style=color:#e6db74>&#34;Apple&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$tree = [<span style=color:#66d9ef>AppleTree</span>]::new()
</span></span><span style=display:flex><span>$tree
</span></span></code></pre></div><p>The result should look something like this:</p><pre tabindex=0><code>Spieces Height Age Color
------- ------ --- -----
Apple        1   0 Green
</code></pre><p>For more information about classes in PowerShell see <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_classes?view=powershell-7.2">Classes</a>.</p></main><a class=previous href=/post/json/>Next: JSON<footer><p><a href=https://powershellbyexample.dev/>Home</a></p><p>by <a href=https://sqlstad.nl target=_blank>Sander Stad</a> |
<a href=https://github.com/sanderstad/powershellbyexample target=_blank>source</a> |
<a href=https://github.com/sanderstad/powershellbyexample/blob/main/LICENSE target=_blank>license</a></p></footer></body></html>