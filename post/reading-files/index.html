<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Reading Files | PowerShell By Example</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-WRS58SRCQM"></script><script>var dnt,doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WRS58SRCQM")}</script><title>PowerShell By Example</title><meta name=description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta name=keywords content="powershell,progamming,tutorial"><link rel=alternate type=application/rss+xml href=https://powershellbyexample.dev/index.xml title=powershellbyexample.dev><link rel=icon type=image/png sizes=32x32 href=https://powershellbyexample.dev/icons/favicon-32x32.png><meta name=twitter:image:src content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta name=twitter:site content="@sqlstad"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Learning PowerShell By Example"><meta name=twitter:description content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><meta property="og:image" content="https://raw.githubusercontent.com/sanderstad/powershellbyexample/main/static/twittercard.png"><meta property="og:image:alt" content="PowerShell by Example"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="600"><meta property="og:site_name" content="PowerShell By Example"><meta property="og:type" content="object"><meta property="og:title" content="Learning PowerShell By Example"><meta property="og:url" content="https://powershellbyexample.dev"><meta property="og:description" content="PowerShell by Example is a hands-on introduction to PowerShell using annotated example programs."><script type=text/javascript>sdkInstance="appInsightsSDK",window[sdkInstance]="appInsights";var sdkInstance,aiName=window[sdkInstance],aisdk=window[aiName]||function(e){function n(e){t[e]=function(){var n=arguments;t.queue.push(function(){t[e].apply(t,n)})}}t={config:e},t.initialize=!0;var t,s,i,a,o=document,r=window;setTimeout(function(){var t=o.createElement("script");t.src=e.url||"https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",o.getElementsByTagName("script")[0].parentNode.appendChild(t)});try{t.cookie=o.cookie}catch{}t.queue=[],t.version=2;for(s=["Event","PageView","Exception","Trace","DependencyData","Metric","PageViewPerformance"];s.length;)n("track"+s.pop());return n("startTrackPage"),n("stopTrackPage"),i="Track"+s[0],(n("start"+i),n("stop"+i),n("setAuthenticatedUserContext"),n("clearAuthenticatedUserContext"),n("flush"),!(!0===e.disableExceptionTracking||e.extensionConfig&&e.extensionConfig.ApplicationInsightsAnalytics&&!0===e.extensionConfig.ApplicationInsightsAnalytics.disableExceptionTracking))&&(n("_"+(s="onerror")),a=r[s],r[s]=function(e,n,o,i,r){var c=a&&a(e,n,o,i,r);return!0!==c&&t["_"+s]({message:e,url:n,lineNumber:o,columnNumber:i,error:r}),c},e.autoExceptionInstrumented=!0),t}({instrumentationKey:"182786de-33f9-4d34-abc9-68ce85a717a0"});window[aiName]=aisdk,aisdk.queue&&0===aisdk.queue.length&&aisdk.trackPageView({})</script></head><body><nav><ul class=menu></ul><hr></nav><div class=article-meta><h1><span class=title><a href=https://powershellbyexample.dev/>PowerShell By Example</a>: Reading Files</span></h1></div><main><p>To demonstrate reading files we need sample files first.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Let&#39;s download a sample file just for the example</span>
</span></span><span style=display:flex><span>$url = <span style=color:#e6db74>&#34;https://gist.githubusercontent.com/sanderstad/7b9593f7f30abb9f17f9026c74ed9c68/raw/d4406c4cbbc427e15fc9d6d92f8bcf3c72a1e70a/samplefile1.txt&#34;</span>
</span></span><span style=display:flex><span>$filePath = Join-Path -Path $env:temp -ChildPath <span style=color:#e6db74>&#34;samplefile1.txt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Invoke-WebRequest -Uri $url -OutFile $filePath
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$url = <span style=color:#e6db74>&#34;https://gist.githubusercontent.com/sanderstad/f59996889fc3ec794d325ad2162648f8/raw/5353480009bd714f9764a093b52f0fabff1078fd/samplefile2.csv&#34;</span>
</span></span><span style=display:flex><span>$filePath = Join-Path -Path $env:temp -ChildPath <span style=color:#e6db74>&#34;samplefile2.txt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Invoke-WebRequest -Uri $url -OutFile $filePath
</span></span></code></pre></div><h2 id=get-content>Get-Content</h2><p>The easiest way to read files in PowerShell is by using the the <code>Get-Content</code> command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Get the content</span>
</span></span><span style=display:flex><span>Get-Content -Path (Join-Path -Path $env:temp -ChildPath <span style=color:#e6db74>&#34;samplefile1.txt&#34;</span>)
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Utilitatis causa amicitia est quaesita.
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Collatio igitur ista te nihil iuvat. Honesta oratio, Socratica, Platonis etiam. Primum in nostrane potestate est, quid meminerimus? Duo Reges: constructio interrete. Quid, si etiam iucunda memoria est praeteritorum malorum? Si quidem, inquit, tollerem, sed relinquo. An nisi populari fama?

Quamquam id quidem licebit iis existimare, qui legerint. Summum a vobis bonum voluptas dicitur. At hoc in eo M. Refert tamen, quo modo. Quid sequatur, quid repugnet, vident. Iam id ipsum absurdum, maximum malum neglegi.
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>$content = Get-Content -Path (Join-Path -Path $env:temp -ChildPath <span style=color:#e6db74>&#34;samplefile1.txt&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$content.GetType()
</span></span><span style=display:flex><span>$content.Count
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     Object[]                                 System.Array

4
</code></pre><p>What PowerShell has done is get the content as an array and each row that end with a newline character will be a new entry.</p><p>To get the first few rows we can do the following</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>$content = Get-Content -Path (Join-Path -Path $env:temp -ChildPath <span style=color:#e6db74>&#34;samplefile1.txt&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$content | Select-Object -First <span style=color:#ae81ff>2</span>
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Utilitatis causa amicitia est quaesita.
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Collatio igitur ista te nihil iuvat. Honesta oratio, Socratica, Platonis etiam. Primum in nostrane potestate est, quid meminerimus? Duo Reges: constructio interrete. Quid, si etiam iucunda memoria est praeteritorum malorum? Si quidem, inquit, tollerem, sed relinquo. An nisi populari fama?
</code></pre><h2 id=import-csv>Import-CSV</h2><p>When you have a specific CSV file, you can use the <code>Import-Csv</code> command to convert the data into Objects.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-powershell data-lang=powershell><span style=display:flex><span>Import-Csv -Path (Join-Path -Path $env:temp -ChildPath <span style=color:#e6db74>&#34;samplefile2.txt&#34;</span>)
</span></span></code></pre></div><p>Result:</p><pre tabindex=0><code>Month   : May
Average : 0.1
2005    : 0
2006    : 0
2007    : 1
2008    : 1
2009    : 0
2010    : 0
2011    : 0
2012    : 2
2013    : 0
2014    : 0
2015    : 0

Month   : Jun
Average : 0.5
2005    : 2
2006    : 1
2007    : 1
2008    : 0
2009    : 0
.........
</code></pre><p>As you can see it returns each and every row as a single object with the data.</p></main><a class=previous href=/post/hashes/>Next: Cryptographic Hashing<footer><p><a href=https://powershellbyexample.dev/>Home</a></p><p>by <a href=https://sqlstad.nl target=_blank>Sander Stad</a> |
<a href=https://github.com/sanderstad/powershellbyexample target=_blank>source</a> |
<a href=https://github.com/sanderstad/powershellbyexample/blob/main/LICENSE target=_blank>license</a></p></footer></body></html>